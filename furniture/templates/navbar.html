{% load static %}
{% load humanize %}
{% load mathfilters %}
<!doctype html>
<html lang="en"">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />
  <meta name="robots" content="noindex, nofollow">

		<!-- Bootstrap CSS -->
		<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="{% static 'css/tiny-slider.css' %}" rel="stylesheet">
		<link href="{% static 'css/style.css' %}" rel="stylesheet">
		<title>Module Furnitures</title>
		<link rel="icon" type="image/png" href="{% static 'images\module-logo.png' %}">
    <script src="https://cdn.tailwindcss.com"></script>
    
<script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      prefix: 'tw-',
      corePlugins: {
        preflight: false,
      }
    }
  </script>
  <style>
    @media screen and (max-width:764px) {
    .desktop-navbar-links {
      display: none !important;
    }
  }
   .bottom-bar-mobile {
  background-color: #E5D9D9;
  overflow: hidden;
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 10%;
  display: flex;
  justify-content: space-evenly;
  
}

/* Style the links inside the navigation bar */
.bottom-bar-mobile a {
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

/* Change the color of links on hover */
.bottom-bar-mobile a:hover {
  background-color: #ddd;
  color: black;
}
  @media screen and (min-width:764px) {
    .mobile-navbar-links {
      display: none !important;
    }
    #mobileSearch {
      display: none !important;
    }
    .bottom-bar-mobile {
      display: none !important;
    }
  }

  </style>
    </head>
    
    <body>
<style>
  .top-banner{
    height: 22px;
  }
  @media screen and (max-width:647px) {
    .top-banner-text {
      font-size:small;
    }
  }
  @media screen and (max-width:592px) {
    .top-banner-text {
      font-size:x-small;
    }
  }
  @media screen and (max-width:430px) {
    .top-banner-text {
      font-size:xx-small;
    }
  }
  .module-logo {
    height: 140px;
    width: 140px;
  }
  @media screen and (max-width:764px) {
    .module-logo {
      height: 30px;
      width: 100px;
    }
    .navbar-brand {
      margin-right: auto;
    }
    .navbar-toggler {
      padding-left: 0px;
    }
  }
 

/* Add a color to the active/current link */

  
</style>
<!--
 <div class="top-banner">
    <p class="top-banner-text" style="text-align: center; color: black;">Currently servicing only in <span style="color: red;">Thrissur, Ernakulam and Alapuzha,</span> Coming soon to all of Kerala</h2>
  </div>
-->
		<!-- Start Header/Navigation -->
    
<nav class="navbar navbar-expand-md navbar-dark py-1" style="background-color: #E5D9D9;">

  <div class="container">

    <!-- Logo -->
    <!-- Toggler -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="{% url 'home' %}">
    <picture>
      <source media="(max-width:764px)" srcset="{% static 'images/mini-logo.png' %}">
      
      <img src="{% static 'images/module-logo.png' %}" alt="Logo" class="module-logo">

      </picture>
          </a>
    
            <div class="d-flex align-items-center gap-3 ms-md-3 my-2 my-md-0 py-1 mobile-navbar-links">
 
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileSearch" aria-controls="mobileSearch" aria-expanded="false" aria-label="Toggle navigation" style="padding: 0;">
      <span class="fa fa-search text-dark"></span>
    </button>
  <!-- Wishlist Icon -->
  <a class="fa fa-heart fs-5 text-dark" href="{% url 'wishlist' %}" style="text-decoration: none;"></a>

  <!-- Cart Icon -->


  <button class="fa fa-shopping-cart fs-5 text-dark" 
            type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" style="background-color: transparent; border: none;">
    </button>
  <!-- User Dropdown or Login Icon -->
  
</div>
    
    <div class="d-flex flex-column flex-md-row align-items-md-center w-100 py-1 desktop-navbar-links">
      <div class="flex-grow-1 my-2 my-md-0 px-md-3">
          <div class="position-relative">
            <form action="{% url 'search' %}" method="get">
            <input id="product-search-input" name="search_word" type="text" class="form-control rounded-pill ps-4 pe-5" placeholder="Hinted search text" required value="{{search_word}}">
            <span class="position-absolute top-50 end-0 translate-middle-y me-3 text-muted">
              <button type="submit" style="border: none; background-color: transparent;">
              <i class="fas fa-search"></i>
              </button>
            </span>
            </form>
          </div>
        </div>
        <div class="d-flex align-items-center gap-3 ms-md-3 my-2 my-md-0 py-1">
  <!-- Track Order Button -->
  <a class="btn btn-sm btn-light" data-bs-toggle="modal" data-bs-target="#trackOrderModal">Track Order</a>

  <!-- Wishlist Icon -->
  <a class="fa fa-heart fs-5 text-dark" href="{% url 'wishlist' %}" style="text-decoration: none;"></a>

  <!-- Cart Icon -->


  <button class="fa fa-shopping-cart fs-5 text-dark" 
            type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" style="background-color: transparent; border: none;">
    </button>
  <!-- User Dropdown or Login Icon -->
  {% if user.is_authenticated %}
  <div class="dropdown">
    <a class="fa fa-user-alt fs-5 text-dark dropdown-toggle" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="text-decoration: none;"></a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
      <li><h6 class="dropdown-header">{{ user.first_name }}</h6></li>
      <li><a class="dropdown-item" href="{% url 'profile' %}">
        <i class="fa-solid fa-user me-2"></i> Profile
      </a></li>
      <li><a class="dropdown-item" href="{% url 'orders' %}">
        <i class="fa-solid fa-truck me-2"></i> Orders
      </a></li>
      <li><a class="dropdown-item" href="{% url 'logoutpage' %}">
        <i class="fas fa-sign-out-alt me-2"></i> Log out
      </a></li>
    </ul>
  </div>
  {% else %}
  <a class="fa fa-sign-in-alt fs-5 text-dark" href="{% url 'loginpage' %}" style="text-decoration: none;"></a>
  {% endif %}
</div>

    </div>

    <div class="collapse navbar-collapse" id="mobileSearch">

      <!-- First row -->
       <hr style="border: none; border-top: 2px dashed #555; margin: 10px 0;">
      <!-- Search (mobile only) -->
       <div class="flex-grow-1 my-2 my-md-0 px-md-3">
          <div class="position-relative">
            <form action="{% url 'search' %}" method="get">
            <input id="product-search-input" name="search_word" type="text" class="form-control rounded-pill ps-4 pe-5" placeholder="Hinted search text" required value="{{search_word}}">
            <span class="position-absolute top-50 end-0 translate-middle-y me-3 text-muted">
              <button type="submit" style="border: none; background-color: transparent;">
              <i class="fas fa-search"></i>
              </button>
            </span>
            </form>
          </div>
        </div>

    </div>
    <!-- Collapse (first row + categories for mobile) -->
    <div class="collapse navbar-collapse" id="mainNavbar">

      <!-- First row -->
<hr style="border: none; border-top: 2px dashed #555; margin: 10px 0;">
      <!-- Categories (mobile only) -->
      <ul class="nav nav-pills flex-column d-md-none p-2" style="background-color: #E5D9D9;">
      {% for room in rooms %}
<li class="nav-item"><a class="nav-link {% if request.resolver_match.kwargs.room_type|default:0 == room.slug %}active{% endif %}" href="{% url 'rooms' room_type=room.slug %}">{{room.name}}</a></li>
      {% endfor %}
      <li class="nav-item"><a class="nav-link" data-bs-toggle="modal" data-bs-target="#trackOrderModal" style=" background-color: aqua; font-weight: bold;">ðŸ“¦ Track Order</a></li>
      </ul>

    </div>
  </div>
  
</nav>

<hr style="border: none; border-top: 2px dashed #555; margin: 0px 0;">
<!-- Categories (desktop only) -->
<div class=" d-none d-md-block py-1"  style="background-color: #E5D9D9;"" >
  <div class="container">
    <ul class="nav nav-pills justify-content-center">
      {% for room in rooms %}
     <li class="nav-item"><a class="nav-link {% if request.resolver_match.kwargs.room_type|default:0 == room.slug %}active{% endif %}" href="{% url 'rooms' room_type=room.slug %}">{{room.name}}</a></li>
    {% endfor %}
    </ul>
  </div>
</div>
<style>
  button.btn.btn-sm.btn-light {
    background-color: #E5D9D9;
    color: black;
}
a.nav-link {
  color: black;
  text-decoration: none;
}
.navbar-dark .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(0, 0, 0, 0.55)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

</style>
<div class="modal fade" id="trackOrderModal" tabindex="-1" aria-labelledby="trackOrderLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="trackOrderLabel">Track Your Order</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="trackOrderForm">
          <div class="mb-3">
            <label for="orderNo" class="form-label">Order Number</label>
            <input type="text" id="orderNo" name="orderNo" class="form-control" required>
          </div>
          <div class="mb-3">
            <label for="emailid" class="form-label">Email Address</label>
            <input type="email" id="emailid" name="email" class="form-control" required>
          </div>
          <p id="delivery" style="color: red;"></p>
          <button type="submit" class="btn btn-primary w-100">Track</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  function productSearch() {
      const searchform = document.getElementById("product-search");
      const searchword = document.getElementById("product-search-input");
      let word = searchword.value;
      searchform.setAttribute("action",`shop/search/${encodeURIComponent(word)}/`);
    }

document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById('trackOrderForm');
    form.addEventListener('submit', function (event) {
        event.preventDefault();
        const orderNo = document.getElementById('orderNo').value;
        const email = document.getElementById('emailid').value;
		const url = `/view_single_order/${orderNo}/${encodeURIComponent(email)}`;
        fetch(url, { method: "GET" })
            .then(response => {
                if (response.ok) {
                    window.location.href = url;
                } else {
                    document.getElementById('delivery').innerText = "The order does not exist";
                }
            })
            .catch(error => {
                document.getElementById('delivery').innerText = "An error occurred";
                console.error(error);
            });
    });
});

</script>

<style>

  .cart-items-body {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .cart-image {
    max-width: 70px;
    height: 70px;
    display: flex;
  }
  .cart-item {
    align-self: flex-start;
  }
  .cart-item-delete {
    align-self: flex-start;
    margin-left: auto;
  }
  .cart-price-details {
    display: flex;
    flex: auto;
  }
 .offcanvas-body {
  display: flex;
  flex-direction: column;
  height: 100%;
}

/* ðŸŸ© Hide scrollbar but keep scroll functionality */
#quick-cart-list {
  overflow-y: auto;
  max-height: calc(100vh - 500px);  /* keep as before */
  padding-right: 6px;

  /* Hide scrollbar */
  scrollbar-width: none;       /* Firefox */
  -ms-overflow-style: none;    /* IE & Edge */
}

#quick-cart-list::-webkit-scrollbar {
  display: none;               /* Chrome, Safari */
}






</style>

<div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas">
  <div id="quick-cart-page">
  {% include "furni/quick-cart.html" with cart_items=cart_items %}
</div>
</div>

<script>
  function updateQuantity(button, change, item_id) {
    const input = button.parentElement.querySelector('input');
    let current = parseInt(input.value, 10);
    current += change;
    if (current < 1) current = 1; // Prevent going below 1
    input.value = current;
    cartUpdate(current, item_id)
  }
  function cartUpdate(quantity,item_id){
    const url = `/update/${item_id}/${quantity}/`
    fetch(url, {
      headers: { "X-Requested-With": "XMLHttpRequest",
      "X-Template-Type": "quick-cart"
      }
    })
      .then(response => response.text())
      .then(html => {
        document.getElementById("quick-cart-page").innerHTML = html;
      })
  }
  function deleteCartItem(item_id) {
    const url = `/remove/${item_id}/`
    fetch(url, {
      headers: { "X-Requested-With": "XMLHttpRequest",
      "X-Template-Type": "quick-cart"
      }
    })
      .then(response => response.text())
      .then(html => {
        document.getElementById("quick-cart-page").innerHTML = html;
      })
  }
</script>

		<!-- End Header/Navigation -->