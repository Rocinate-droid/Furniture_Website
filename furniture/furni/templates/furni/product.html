{% extends 'main.html' %}
{% block content %}
{% load static %}
 <div class="container py-5">
    <div class="row">
      <!-- Product Images -->
      <div class="col-md-6">
        <img id="mainImage" src="{{product.img.url}}" class="img-fluid mb-3" alt="Main Image">
        <div class="d-flex">
          <img src="{{product.img.url}}" class="thumbnail-img active" width="60" onclick="changeImage(this)">
          <img src="{{product.img2.url}}" class="thumbnail-img" width="60" onclick="changeImage(this)">
          <img src="{{product.img3.url}}" class="thumbnail-img" width="60" onclick="changeImage(this)">
          <img src="{{product.img3.url}}" class="thumbnail-img" width="60" onclick="changeImage(this)">
        </div>
      </div>
      <!-- Product Details -->
      <div class="col-md-6">
        <h4>{{product.name}}</h4>
        <p class="mb-1"><strong>₹{{product.discounted_price}}</strong> <span class="price-original">₹{{product.original_price}}</span> <small>(Including GST)</small></p>
        <p class="text-success">You Save ₹{{product.savings}} ({{product.savings_percentage}}% OFF)</p>
        <p>{{product.warranty}} Year Warranty</p>
        <table class="table table-sm">
          <tbody>
            <tr>
              <td><strong>Total Savings</strong></td>
              <td class="text-danger">₹{{product.savings}}</td>
            </tr>
            <tr>
              <td><strong>Assembly</strong></td>
              <td>{{product.assembly}}</td>
            </tr>
            <tr>
              <td><strong>Customization</strong></td>
              <td>{{product.customization}}</td>
            </tr>
            <tr>
              <td><strong>Tax</strong></td>
              <td>18%</td>
            </tr>
          </tbody>
        </table>

        <!-- Quantity & Price -->
        <div class="d-flex align-items-center mb-3">
          <button class="btn btn-outline-secondary btn-sm" onclick="adjustQty(-1)">-</button>
          <input id="qtyInput" type="text" value="1" class="form-control form-control-sm mx-2 text-center" style="width: 50px;">
          <button class="btn btn-outline-secondary btn-sm" onclick="adjustQty(1)">+</button>
          <strong class="ms-3">₹<span id="totalPrice">{{product.discounted_price}}</span></strong>
        </div>

        <!-- Actions -->
        <div class="d-flex flex-column flex-sm-row gap-2">
          <button class="btn btn-orange w-100">Buy Now</button>
          <button class="btn btn-outline-secondary w-100">Add to Cart</button>
        </div>
      </div>

    </div>
  </div>

  <!-- JS -->
  <script>
    const mainImage = document.getElementById("mainImage");
    const thumbnails = document.querySelectorAll(".thumbnail-img");
    const qtyInput = document.getElementById("qtyInput");
    const totalPriceEl = document.getElementById("totalPrice");
    const pricePerUnit = parseInt(document.getElementById("totalPrice").textContent.replace(",", ""));

    function changeImage(el) {
      thumbnails.forEach(img => img.classList.remove("active"));
      el.classList.add("active");
      mainImage.src = el.src;
    }

    function adjustQty(val) {
      let qty = parseInt(qtyInput.value);
      qty = isNaN(qty) ? 1 : qty;
      qty = Math.max(1, qty + val);
      qtyInput.value = qty;
      totalPriceEl.textContent = qty * pricePerUnit;
    }

    qtyInput.addEventListener("input", () => {
      let qty = parseInt(qtyInput.value);
      qty = isNaN(qty) || qty < 1 ? 1 : qty;
      qtyInput.value = qty;
      totalPriceEl.textContent = qty * pricePerUnit;
    });
  </script>
{% endblock content %}